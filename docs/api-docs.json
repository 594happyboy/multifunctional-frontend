{"openapi":"3.0.1","info":{"title":"多功能后端系统 API","description":"包含博客、文件管理等功能的后端系统","contact":{"name":"ZZY","email":"your-email@example.com"},"license":{"name":"Apache 2.0","url":"https://www.apache.org/licenses/LICENSE-2.0.html"},"version":"1.0.0"},"servers":[{"url":"http://localhost:8080","description":"Generated server url"}],"tags":[{"name":"排序管理","description":"分组和文档的批量排序与移动"},{"name":"分组管理","description":"文档分组的增删改查、树形结构管理"},{"name":"文档管理","description":"文档的增删改查、发布状态管理"},{"name":"认证管理","description":"用户登录、游客令牌等认证相关接口"},{"name":"文件管理","description":"文件上传、下载、删除等API"}],"paths":{"/api/sort/groups":{"post":{"tags":["排序管理"],"summary":"批量更新分组排序","description":"批量更新分组的父分组和排序索引","operationId":"sortGroups","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/GroupSortRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponse"}}}}}}},"/api/sort/documents":{"post":{"tags":["排序管理"],"summary":"批量更新文档排序","description":"批量更新文档的分组和排序索引","operationId":"sortDocuments","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/DocumentSortRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponse"}}}}}}},"/api/groups":{"get":{"tags":["分组管理"],"summary":"获取分组树","description":"获取当前用户的分组树形结构","operationId":"getGroupTree","parameters":[{"name":"rootOnly","in":"query","required":false,"schema":{"type":"boolean"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponseListGroupResponse"}}}}}},"post":{"tags":["分组管理"],"summary":"创建分组","description":"创建新的文档分组","operationId":"createGroup","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateGroupRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponseGroupResponse"}}}}}}},"/api/files/upload":{"post":{"tags":["文件管理"],"summary":"上传文件","description":"支持单文件上传，最大100MB","operationId":"uploadFile","parameters":[{"name":"userId","in":"query","description":"用户ID（可选）","required":false,"schema":{"type":"integer","format":"int64"}}],"requestBody":{"content":{"application/json":{"schema":{"required":["file"],"type":"object","properties":{"file":{"type":"string","description":"上传的文件","format":"binary"}}}}}},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponseFileResponse"}}}}}}},"/api/files/cache/clear":{"post":{"tags":["文件管理"],"summary":"清除所有缓存","description":"清除Redis中的所有文件相关缓存（管理功能）","operationId":"clearCache","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponseString"}}}}}}},"/api/documents":{"get":{"tags":["文档管理"],"summary":"查询文档列表","description":"分页查询文档，支持搜索、筛选","operationId":"getDocuments","parameters":[{"name":"q","in":"query","required":false,"schema":{"type":"string"}},{"name":"status","in":"query","required":false,"schema":{"type":"string"}},{"name":"groupId","in":"query","required":false,"schema":{"type":"integer","format":"int64"}},{"name":"page","in":"query","required":false,"schema":{"type":"integer","format":"int32","default":1}},{"name":"size","in":"query","required":false,"schema":{"type":"integer","format":"int32","default":20}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponseDocumentListResponse"}}}}}},"post":{"tags":["文档管理"],"summary":"创建文档","description":"创建新的文档（Markdown或PDF）","operationId":"createDocument","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateDocumentRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponseDocumentDetail"}}}}}}},"/api/auth/visitor":{"post":{"tags":["认证管理"],"summary":"获取游客令牌","description":"获取只读访问令牌，用于访问已发布的内容","operationId":"getVisitorToken","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/VisitorTokenRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponseVisitorTokenResponse"}}}}}}},"/api/auth/refresh":{"post":{"tags":["认证管理"],"summary":"刷新令牌","description":"使用刷新令牌获取新的访问令牌","operationId":"refreshToken","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RefreshTokenRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponseRefreshTokenResponse"}}}}}}},"/api/auth/login":{"post":{"tags":["认证管理"],"summary":"用户登录","description":"使用用户名和密码登录，返回JWT令牌","operationId":"login","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponseLoginResponse"}}}}}}},"/api/groups/{id}":{"delete":{"tags":["分组管理"],"summary":"删除分组","description":"删除分组（软删除），如果有子分组则无法删除","operationId":"deleteGroup","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int64"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponse"}}}}}},"patch":{"tags":["分组管理"],"summary":"更新分组","description":"更新分组信息，包括名称、父分组、排序","operationId":"updateGroup","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int64"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateGroupRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponseGroupResponse"}}}}}}},"/api/documents/{id}":{"get":{"tags":["文档管理"],"summary":"获取文档详情","description":"根据ID获取文档详细信息","operationId":"getDocument","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int64"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponseDocumentDetail"}}}}}},"delete":{"tags":["文档管理"],"summary":"删除文档","description":"删除文档（软删除）","operationId":"deleteDocument","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int64"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponse"}}}}}},"patch":{"tags":["文档管理"],"summary":"更新文档","description":"更新文档信息，包括内容、状态、分组等","operationId":"updateDocument","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int64"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateDocumentRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponseDocumentDetail"}}}}}}},"/api/files":{"get":{"tags":["文件管理"],"summary":"获取文件列表","description":"分页查询文件列表，支持搜索和排序","operationId":"getFileList","parameters":[{"name":"page","in":"query","description":"页码，从1开始","required":false,"schema":{"type":"integer","format":"int32","default":1}},{"name":"size","in":"query","description":"每页数量","required":false,"schema":{"type":"integer","format":"int32","default":10}},{"name":"keyword","in":"query","description":"搜索关键词","required":false,"schema":{"type":"string"}},{"name":"sortBy","in":"query","description":"排序字段","required":false,"schema":{"type":"string","default":"uploadTime"}},{"name":"order","in":"query","description":"排序方式：asc/desc","required":false,"schema":{"type":"string","default":"desc"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponseFileListResponse"}}}}}}},"/api/files/{id}":{"get":{"tags":["文件管理"],"summary":"获取文件详情","description":"根据文件ID获取详细信息","operationId":"getFileInfo","parameters":[{"name":"id","in":"path","description":"文件ID","required":true,"schema":{"type":"integer","format":"int64"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponseFileResponse"}}}}}},"delete":{"tags":["文件管理"],"summary":"删除文件","description":"根据文件ID删除文件（逻辑删除）","operationId":"deleteFile","parameters":[{"name":"id","in":"path","description":"文件ID","required":true,"schema":{"type":"integer","format":"int64"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponseBoolean"}}}}}}},"/api/files/{id}/download":{"get":{"tags":["文件管理"],"summary":"下载文件","description":"根据文件ID下载文件","operationId":"downloadFile","parameters":[{"name":"id","in":"path","description":"文件ID","required":true,"schema":{"type":"integer","format":"int64"}}],"responses":{"200":{"description":"OK"}}}},"/api/files/batch":{"delete":{"tags":["文件管理"],"summary":"批量删除文件","description":"根据文件ID列表批量删除","operationId":"batchDeleteFiles","requestBody":{"content":{"application/json":{"schema":{"type":"array","description":"文件ID列表","items":{"type":"integer","format":"int64"}}}},"required":true},"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/ApiResponseMapStringObject"}}}}}}}},"components":{"schemas":{"GroupSortItem":{"required":["id","sortIndex"],"type":"object","properties":{"id":{"type":"integer","format":"int64"},"parentId":{"type":"integer","format":"int64"},"sortIndex":{"type":"integer","format":"int32"}}},"GroupSortRequest":{"required":["items"],"type":"object","properties":{"items":{"type":"array","items":{"$ref":"#/components/schemas/GroupSortItem"}}}},"ApiResponse":{"required":["code","message","timestamp"],"type":"object","properties":{"code":{"type":"integer","format":"int32"},"message":{"type":"string"},"data":{"type":"object"},"timestamp":{"type":"integer","format":"int64"}}},"DocumentSortItem":{"required":["id","sortIndex"],"type":"object","properties":{"id":{"type":"integer","format":"int64"},"groupId":{"type":"integer","format":"int64"},"sortIndex":{"type":"integer","format":"int32"}}},"DocumentSortRequest":{"required":["items"],"type":"object","properties":{"items":{"type":"array","items":{"$ref":"#/components/schemas/DocumentSortItem"}}}},"CreateGroupRequest":{"required":["name"],"type":"object","properties":{"name":{"type":"string"},"parentId":{"type":"integer","format":"int64"}}},"ApiResponseGroupResponse":{"required":["code","message","timestamp"],"type":"object","properties":{"code":{"type":"integer","format":"int32"},"message":{"type":"string"},"data":{"$ref":"#/components/schemas/GroupResponse"},"timestamp":{"type":"integer","format":"int64"}}},"GroupResponse":{"required":["id","name","sortIndex","userId"],"type":"object","properties":{"id":{"type":"integer","format":"int64"},"userId":{"type":"integer","format":"int64"},"name":{"type":"string"},"parentId":{"type":"integer","format":"int64"},"sortIndex":{"type":"integer","format":"int32"},"createdAt":{"type":"string","format":"date-time"},"updatedAt":{"type":"string","format":"date-time"},"children":{"type":"array","items":{"$ref":"#/components/schemas/GroupResponse"}}}},"ApiResponseFileResponse":{"required":["code","message","timestamp"],"type":"object","properties":{"code":{"type":"integer","format":"int32"},"message":{"type":"string"},"data":{"$ref":"#/components/schemas/FileResponse"},"timestamp":{"type":"integer","format":"int64"}}},"FileResponse":{"required":["downloadCount","downloadUrl","fileExtension","fileName","fileSize","fileSizeFormatted","fileType","id","uploadTime"],"type":"object","properties":{"id":{"type":"integer","format":"int64"},"fileName":{"type":"string"},"fileSize":{"type":"integer","format":"int64"},"fileSizeFormatted":{"type":"string"},"fileType":{"type":"string"},"fileExtension":{"type":"string"},"uploadTime":{"type":"string"},"downloadCount":{"type":"integer","format":"int32"},"downloadUrl":{"type":"string"}}},"ApiResponseString":{"required":["code","message","timestamp"],"type":"object","properties":{"code":{"type":"integer","format":"int32"},"message":{"type":"string"},"data":{"type":"string"},"timestamp":{"type":"integer","format":"int64"}}},"CreateDocumentRequest":{"required":["title","type"],"type":"object","properties":{"title":{"type":"string"},"groupId":{"type":"integer","format":"int64"},"type":{"type":"string"},"contentMd":{"type":"string"}}},"ApiResponseDocumentDetail":{"required":["code","message","timestamp"],"type":"object","properties":{"code":{"type":"integer","format":"int32"},"message":{"type":"string"},"data":{"$ref":"#/components/schemas/DocumentDetail"},"timestamp":{"type":"integer","format":"int64"}}},"DocumentDetail":{"required":["id","sortIndex","status","title","type","userId"],"type":"object","properties":{"id":{"type":"integer","format":"int64"},"userId":{"type":"integer","format":"int64"},"groupId":{"type":"integer","format":"int64"},"title":{"type":"string"},"type":{"type":"string"},"status":{"type":"string"},"contentMd":{"type":"string"},"sortIndex":{"type":"integer","format":"int32"},"createdAt":{"type":"string","format":"date-time"},"updatedAt":{"type":"string","format":"date-time"}}},"VisitorTokenRequest":{"type":"object","properties":{"targetUser":{"type":"string"}}},"ApiResponseVisitorTokenResponse":{"required":["code","message","timestamp"],"type":"object","properties":{"code":{"type":"integer","format":"int32"},"message":{"type":"string"},"data":{"$ref":"#/components/schemas/VisitorTokenResponse"},"timestamp":{"type":"integer","format":"int64"}}},"UserInfo":{"required":["id","username"],"type":"object","properties":{"id":{"type":"integer","format":"int64"},"username":{"type":"string"},"nickname":{"type":"string"}}},"VisitorTokenResponse":{"required":["targetUser","visitorToken"],"type":"object","properties":{"visitorToken":{"type":"string"},"targetUser":{"$ref":"#/components/schemas/UserInfo"}}},"RefreshTokenRequest":{"required":["refreshToken"],"type":"object","properties":{"refreshToken":{"type":"string"}}},"ApiResponseRefreshTokenResponse":{"required":["code","message","timestamp"],"type":"object","properties":{"code":{"type":"integer","format":"int32"},"message":{"type":"string"},"data":{"$ref":"#/components/schemas/RefreshTokenResponse"},"timestamp":{"type":"integer","format":"int64"}}},"RefreshTokenResponse":{"required":["accessToken"],"type":"object","properties":{"accessToken":{"type":"string"}}},"LoginRequest":{"required":["password","username"],"type":"object","properties":{"username":{"type":"string"},"password":{"type":"string"}}},"ApiResponseLoginResponse":{"required":["code","message","timestamp"],"type":"object","properties":{"code":{"type":"integer","format":"int32"},"message":{"type":"string"},"data":{"$ref":"#/components/schemas/LoginResponse"},"timestamp":{"type":"integer","format":"int64"}}},"LoginResponse":{"required":["accessToken","user"],"type":"object","properties":{"accessToken":{"type":"string"},"user":{"$ref":"#/components/schemas/UserInfo"}}},"UpdateGroupRequest":{"type":"object","properties":{"name":{"type":"string"},"parentId":{"type":"integer","format":"int64"},"sortIndex":{"type":"integer","format":"int32"}}},"UpdateDocumentRequest":{"type":"object","properties":{"title":{"type":"string"},"groupId":{"type":"integer","format":"int64"},"contentMd":{"type":"string"},"status":{"type":"string"},"sortIndex":{"type":"integer","format":"int32"}}},"ApiResponseListGroupResponse":{"required":["code","message","timestamp"],"type":"object","properties":{"code":{"type":"integer","format":"int32"},"message":{"type":"string"},"data":{"type":"array","items":{"$ref":"#/components/schemas/GroupResponse"}},"timestamp":{"type":"integer","format":"int64"}}},"ApiResponseFileListResponse":{"required":["code","message","timestamp"],"type":"object","properties":{"code":{"type":"integer","format":"int32"},"message":{"type":"string"},"data":{"$ref":"#/components/schemas/FileListResponse"},"timestamp":{"type":"integer","format":"int64"}}},"FileListResponse":{"required":["files","page","size","total"],"type":"object","properties":{"total":{"type":"integer","format":"int64"},"page":{"type":"integer","format":"int32"},"size":{"type":"integer","format":"int32"},"files":{"type":"array","items":{"$ref":"#/components/schemas/FileResponse"}}}},"ApiResponseDocumentListResponse":{"required":["code","message","timestamp"],"type":"object","properties":{"code":{"type":"integer","format":"int32"},"message":{"type":"string"},"data":{"$ref":"#/components/schemas/DocumentListResponse"},"timestamp":{"type":"integer","format":"int64"}}},"DocumentItem":{"required":["id","sortIndex","status","title","type"],"type":"object","properties":{"id":{"type":"integer","format":"int64"},"title":{"type":"string"},"type":{"type":"string"},"status":{"type":"string"},"groupId":{"type":"integer","format":"int64"},"sortIndex":{"type":"integer","format":"int32"},"createdAt":{"type":"string","format":"date-time"},"updatedAt":{"type":"string","format":"date-time"}}},"DocumentListResponse":{"required":["items","total"],"type":"object","properties":{"items":{"type":"array","items":{"$ref":"#/components/schemas/DocumentItem"}},"total":{"type":"integer","format":"int64"}}},"ApiResponseBoolean":{"required":["code","message","timestamp"],"type":"object","properties":{"code":{"type":"integer","format":"int32"},"message":{"type":"string"},"data":{"type":"boolean"},"timestamp":{"type":"integer","format":"int64"}}},"ApiResponseMapStringObject":{"required":["code","message","timestamp"],"type":"object","properties":{"code":{"type":"integer","format":"int32"},"message":{"type":"string"},"data":{"type":"object","additionalProperties":{"type":"object"}},"timestamp":{"type":"integer","format":"int64"}}}}}}
